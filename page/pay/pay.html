<!DOCTYPE html>
<html>

	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<title></title>
		<link href="../../css/mui.min.css" rel="stylesheet" />
		<link rel="stylesheet" href="../../css/share_main.css" />
		<link rel="stylesheet" href="../../css/common/popup.css"/>
		<script src="../../js/common/popup.js"></script>
		<script src="../../js/mui.min.js"></script>
		<style>
			
		</style>
	</head>
	<body class="bg-color">
		<header class="mui-bar mui-bar-nav nav_header">
			<img src="../../img/left.png" alt="" class="header_left_img mui-action-back"/>
			<span>Withdraw</span>
		</header>

		<footer class="mui-bar mui-bar-footer">
			<button class="nav_footer mui-btn" id="next-step">Next Step</button>
		</footer>

		<div class="mui-content">
			<ul class="mui-table-view top_header" id="ul">
				<li class="mui-table-view-cell ">
					<div class="li_left_title"><span class="left-title">Total</span></div>
					<div class="li_input_l">
						<span class="mui-pull-right">$ <span id="available-cash">20.00</span></span>
					</div>
				</li>
				<li class="mui-table-view-cell ">
					<span class="li_left-title">Date</span>
					<span class="mui-pull-right">2015-06-20 18:07</span>
				</li>
				<li class="mui-table-view-cell ">
					<span class="li_left-title">Use Coupon</span>
					<span class="mui-pull-right">$10.00</span>  
				</li>

				<li class="mui-table-view-cell">
					<div class="li_left_title">
						<img src="../../img/wallet3.png" alt="" class="li_left_img" />
					</div>
					<img src="../../img/shouyin2.png" alt="" class="li_right_img right-logo active" data-action='yue'/>
					<div class="li_input_s">
						<div class="li_title_1"> <span>Use <span class="pay">wallet</span></span></div>
						<div class="li_title_2"> <span>go to wallet</span></div>
					</div>
				</li>
				<li class="mui-table-view-cell">
					<div class="li_left_title">
						<img src="../../img/paypal.png" alt="" class="li_left_img" />
					</div>
					<img src="../../img/shouyin.png" alt="" class="li_right_img right-logo" data-action = 'paypal'/> 
					<div class="li_input_s">
						<div class="li_title_1"><span>Use <span class="Pay">Pay</span><span class="pal">pal</span></span></div>
						<div class="li_title_2"><span>go to paypal page</span></div>
					</div>
				</li>
			</ul>
		</div>

		<script src="../../js/utils.js"></script>
		<script src="../../js/jquery.min.js"></script>
		<script type="text/javascript">
			mui.init();
			mui.plusReady(function() {
				// 定单号
				var cid = plus.webview.currentWebview().orderid;
				var money = plus.webview.currentWebview().money;
				var orderid = cid;
				var payid;
				var cpage = plus.webview.currentWebview();
				$('.right-logo').on('tap', function() {
					$('.right-logo').removeClass('active').attr('src','../../img/shouyin.png');
					$(this).addClass('active').attr('src','../../img/shouyin2.png');
				})
				
				// 弹出框属性
				var options = {
					height : 180,
					title : {
						height : 40,
						content : ""
					},
					main : {
						content : ""
					},
					buttons : []
				}
				
				
				var pop;
				document.getElementById("next-step").addEventListener("tap", function() {
					/*plus.nativeUI.showWaiting("付款中...", {
						background: '#d1d1d1'
					})
					mui.ajax(BASEURL + "pay/temp", {
						data : {
							orderId : orderid
						},
						type : "post",
						success : function(data){
							if(data.ret == 1){
								plus.nativeUI.closeWaiting();
								openWindow("./result.html")
								setTimeout(function(){
									cpage.close("none", 0)
								}, 230)
							}
						},
						error : function(xhr, type){
							console.log(xhr.status);			// 支付接口 404
						}
					})*/
					var action = $('.right-logo').filter('.active').attr('data-action')
					if (action == 'yue') {
						// 弹出框样式
						pop = null;
						options.title.content = "输入密码";
						options.main.content = "<div class='popup-input-wrap'>"+
													"<input type='password' maxlength='20' placeholder='please enter your password' class='input-withdraw'/>"+
												"</div>"+
												"<div class='input-extras'>Forget Your Password?</div>";
						options.buttons[0] = {
							name : "OK",
							click : function(){
								// 支付密码验证接口
								
							}
						}
						options.buttons[1] = {
							name : "cancel",
							click : function(){ return true; }
						}
						pop = new Popup(options)
						pop.show();
					}
				}, false)

				// 忘记密码
				mui("body").on("tap", ".input-extras", function(){
					this.style.color = "red";
					pop.hide(document.getElementById("lee-mask"), document.getElementById("lee-content-wrap"));
					
					setTimeout(function(){
						
						options.title.content = "please input your password";
						options.main.content = "<div class='popup-input-wrap'>"+
												"<input type='password' maxlength='20' placeholder='please enter your password' class='input-withdraw'/>"+
											"</div>";
						options.buttons[0]["name"] = "Ok";
						options.buttons[0].click = function(){
							//  忘记密码接口
							
							
							
							
							
							
						}
						if(options.buttons.length == 2){
							options.buttons.splice(1,1);
						}
						pop = new Popup(options)
						pop.show();
					}, 400)
				})


				function paymoney(paytype, paymoney, cb) {
					myAjax({
						url: 'pay/save',
						data: {
							orderId: orderid,
							type: paytype,
							money: paymoney
						}
					}, function(data) {
						if (data.ret == 1) {
							payid = data.res.rechargeId;
							cb();
						}
					}, function(xhr, type) {
						mui.toast(xhr.status + ":" + type);
					})
				}
			})
		</script>
	</body>

</html>